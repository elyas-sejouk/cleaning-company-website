---
import Layout from "../layouts/Layout.astro";
import Navbar from "../components/Navbar.astro";
import Button from "../components/Button.astro";
import Reviews from "../components/Reviews.astro";
import FAQ from "../components/FAQ.astro";
import ContactForm from "../components/ContactForm.astro";
import Footer from "../components/Footer.astro";
import { Image } from "astro:assets";
import logoImg from "../assets/logo.avif";
import { services } from "../data/services.js";

// Dynamic import of service images
const images = import.meta.glob<{ default: ImageMetadata }>(
	"/src/assets/services/*.{jpeg,jpg,png,gif}",
);

// This is where you will stick your 'Smiley House' image later.
// For now, we use a placeholder div.
---

<Layout title="Éclat de Sud - Nettoyage Airbnb & Chantier">
	<main>
		<Navbar />

		<section
			class="container mx-auto px-6 py-16 md:py-24 grid md:grid-cols-2 gap-12 items-center"
		>
			<div class="space-y-8 text-center md:text-left">
				<h1 class="font-retro text-5xl md:text-7xl leading-[1.1]">
					Quand la propreté rencontre le <br />
					<span class="text-soapy-yellow drop-shadow-md"
						>soleil !</span
					>
				</h1>

				<p
					class="text-lg md:text-xl font-medium max-w-lg mx-auto md:mx-0"
				>
					Spécialiste <strong>Airbnb</strong>, <strong
						>Fin de Chantier</strong
					> & <strong>Événementiel</strong> sur l'Arc Méditerranéen (Narbonne,
					Béziers, Montpellier).
				</p>

				<div
					class="flex flex-col sm:flex-row gap-4 justify-center md:justify-start pt-2"
				>
					<Button
						text="Demander un Devis"
						href="#devis"
						variant="primary"
					/>
					<Button
						text="Nos prestations"
						href="#services"
						variant="secondary"
					/>
				</div>
			</div>

			<div
				class="flex justify-center relative hover:scale-105 transition-transform duration-300"
			>
				<div
					class="absolute top-4 right-10 w-32 h-32 bg-soapy-yellow rounded-full border-3 border-soapy-black -z-10"
				>
				</div>

				<Image
					src={logoImg}
					alt="Logo Éclat de Sud"
					width={248}
					densities={[1.5, 2]}
					loading="eager"
					fetchpriority="high"
					class="w-64 md:w-80 border-3 border-soapy-black rounded-xl shadow-retro rotate-2 h-auto"
				/>
			</div>
		</section>

		<section
			id="services"
			class="bg-white border-y-3 border-soapy-black py-20"
		>
			<div class="container mx-auto px-6">
				<h2 class="font-retro text-4xl md:text-5xl text-center mb-16">
					Nos Missions Propreté
				</h2>

				<div class="grid md:grid-cols-3 gap-8">
					{
						services.map((service) => (
							<a
								href={`/services/${service.slug}`}
								class="group block h-full"
							>
								<div class="bg-soapy-green border-3 border-soapy-black rounded-2xl shadow-retro hover:translate-y-[-4px] hover:shadow-retro-hover transition-all h-full flex flex-col relative overflow-hidden">
									<div class="relative">
										{images[`/src/assets/services/${service.imageFile}`] ? (
											<Image
												src={images[`/src/assets/services/${service.imageFile}`]()}
												alt={`${service.title} - Éclat de Sud Narbonne`}
												width={600}
												class="w-full h-48 object-cover border-b-3 border-soapy-black group-hover:scale-105 transition-transform duration-500"
											/>
										) : (
											<div class="w-full h-48 bg-gray-200 border-b-3 border-soapy-black flex items-center justify-center text-gray-500 font-bold">
												Image non trouvée
											</div>
										)}
										
										<!-- Floating Badge Icon -->
										<div class="absolute bottom-4 right-4 w-14 h-14 bg-white rounded-full border-3 border-soapy-black flex items-center justify-center text-3xl shadow-retro z-10 group-hover:scale-110 transition-transform duration-300">
											{service.icon}
										</div>
									</div>

									<div class="p-8 flex flex-col flex-grow">
										<div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity font-bold text-xl z-10 bg-white/80 backdrop-blur-sm px-2 rounded-full border-2 border-soapy-black">
											↗
										</div>

										<h3 class="font-retro text-2xl mb-3 group-hover:text-soapy-orange transition-colors">
											{service.title}
										</h3>
										<p class="font-medium text-soapy-black mb-6">
											{service.shortDesc}
										</p>
	
										<div class="mt-auto pt-4 font-bold text-sm underline decoration-2 decoration-soapy-black group-hover:decoration-soapy-yellow">
											En savoir plus
										</div>
									</div>
								</div>
							</a>
						))
					}
				</div>
			</div>
		</section>

		<Reviews />
		<FAQ />

		<section class="container mx-auto px-6 py-20">
			<div class="max-w-4xl mx-auto">
				<ContactForm />
			</div>
		</section>

		<Footer />
	</main>
</Layout>
